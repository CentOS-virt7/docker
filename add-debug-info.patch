From 62049055b6e013832ce917a6de8e998f8201979e Mon Sep 17 00:00:00 2001
From: rpm-build <rpm-build>
Date: Tue, 2 Jun 2015 12:41:40 +0200
Subject: [PATCH] add debug info

---
 hack/make/.dockerinit        | 1 +
 hack/make/.dockerinit-gccgo  | 1 +
 hack/make/.ensure-httpserver | 2 +-
 hack/make/binary             | 1 +
 hack/make/gccgo              | 1 +
 5 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/hack/make/.dockerinit b/hack/make/.dockerinit
index 4a62ee1..cc54834 100644
--- a/hack/make/.dockerinit
+++ b/hack/make/.dockerinit
@@ -12,6 +12,7 @@ go build \
 		$LDFLAGS
 		$LDFLAGS_STATIC
 		-extldflags \"$EXTLDFLAGS_STATIC\"
+		-B 0x$(head -c20 /dev/urandom|od -An -tx1|tr -d ' \n')
 	" \
 	./dockerinit
 
diff --git a/hack/make/.dockerinit-gccgo b/hack/make/.dockerinit-gccgo
index 9890863..5dbef11 100644
--- a/hack/make/.dockerinit-gccgo
+++ b/hack/make/.dockerinit-gccgo
@@ -13,6 +13,7 @@ go build --compiler=gccgo \
 		-Wl,--no-export-dynamic
 		$EXTLDFLAGS_STATIC_DOCKER
 		-lnetgo
+		-B 0x$(head -c20 /dev/urandom|od -An -tx1|tr -d ' \n')
 	" \
 	./dockerinit
 
diff --git a/hack/make/.ensure-httpserver b/hack/make/.ensure-httpserver
index 38659ed..ce45895 100644
--- a/hack/make/.ensure-httpserver
+++ b/hack/make/.ensure-httpserver
@@ -8,7 +8,7 @@ dir="$DEST/httpserver"
 mkdir -p "$dir"
 (
 	cd "$dir"
-	GOOS=linux GOARCH=amd64 go build -o httpserver github.com/docker/docker/contrib/httpserver
+	GOOS=linux GOARCH=amd64 go build -ldflags "-B 0x$(head -c20 /dev/urandom|od -An -tx1|tr -d ' \n')" -o httpserver github.com/docker/docker/contrib/httpserver
 	cp ../../../../contrib/httpserver/Dockerfile .
 	docker build -qt httpserver . > /dev/null
 )
diff --git a/hack/make/binary b/hack/make/binary
index d764336..6392da1 100644
--- a/hack/make/binary
+++ b/hack/make/binary
@@ -14,6 +14,7 @@ go build \
 	-ldflags "
 		$LDFLAGS
 		$LDFLAGS_STATIC_DOCKER
+		-B 0x$(head -c20 /dev/urandom|od -An -tx1|tr -d ' \n')
 	" \
 	./docker
 
diff --git a/hack/make/gccgo b/hack/make/gccgo
index 972934a..6b5a3a3 100644
--- a/hack/make/gccgo
+++ b/hack/make/gccgo
@@ -18,6 +18,7 @@ go build -compiler=gccgo \
 		$EXTLDFLAGS_STATIC_DOCKER
 		-Wl,--no-export-dynamic
 		-ldl
+		-B 0x$(head -c20 /dev/urandom|od -An -tx1|tr -d ' \n')
 	" \
 	./docker
 
-- 
1.9.3

